{
  "initializationAction": [
    "c.npc.set_chatting();",
    "v.healer = c.npc.find_nearby_block('cobblemon:healing_machine');",
    "v.has_healer = v.healer != 0;",
    "v.full_health = c.player.is_party_at_full_health();",
    "v.has_charge = v.has_healer == true && v.full_health == false && q.player.can_heal_at_healer(v.healer) == true;",
    "v.landing_page = !v.has_healer ? 'no_machine' : (v.full_health ? 'already_healthy' : (v.has_charge ? 'offer' : 'no_charge'));"
  ],
  "speakers": {
    "infirmiere": {
      "name": {
        "type": "expression",
        "expression": "q.npc.name"
      },
      "face": "q.npc.face();",
      "gibber": {
        "step": 3,
        "interval": 0.08
      }
    },
    "player": {
      "face": "q.player.face();",
      "name": {
        "type": "expression",
        "expression": "q.player.username"
      }
    }
  },
  "pages": [
    {
      "id": "greeting",
      "speaker": "infirmiere",
      "lines": [
        "Bienvenue au Centre Pokémon !",
        "Nous allons prendre soin de vous et de vos Pokémon."
      ],
      "input": "q.dialogue.set_page(v.landing_page);"
    },
    {
      "id": "no_machine",
      "speaker": "infirmiere",
      "lines": [
        "Je vous proposerais bien de soigner vos Pokémon,",
        "mais je ne trouve pas ma machine de soins...",
        "Je suis vraiment désolée !"
      ],
      "input": "q.dialogue.close();"
    },
    {
      "id": "already_healthy",
      "speaker": "infirmiere",
      "lines": [
        "Je vous proposerais bien de soigner vos Pokémon,",
        "mais ils sont déjà en parfaite santé !"
      ],
      "input": "q.dialogue.close();"
    },
    {
      "id": "no_charge",
      "speaker": "infirmiere",
      "lines": [
        "J'aimerais soigner vos Pokémon mais ma machine est occupée !",
        "Revenez plus tard s'il vous plaît !"
      ],
      "input": "q.dialogue.close();"
    },
    {
      "id": "offer",
      "speaker": "infirmiere",
      "lines": ["Souhaitez-vous que je soigne vos Pokémon ?"],
      "input": {
        "type": "option",
        "vertical": true,
        "options": [
          {
            "text": "Oui, s'il vous plaît",
            "value": "yes",
            "action": [
              "v.callback_dialogue = 'healed';",
              "c.npc.run_action_effect('npc_heal_player_pokemon');",
              "q.dialogue.close();"
            ]
          },
          {
            "text": "Non merci",
            "value": "no",
            "action": "q.dialogue.set_page('goodbye');"
          }
        ]
      }
    },
    {
      "id": "goodbye",
      "speaker": "infirmiere",
      "lines": ["D'accord, à plus tard !"],
      "input": "q.dialogue.close();"
    }
  ]
}
